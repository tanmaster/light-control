from time import sleep

import hid

from light_control.constants import DEVICE_ID

dev = hid.device()
dev.open(**DEVICE_ID)  # use your vid/pid

commands = [
    "534301013780010000ff010200ff0002030000ff0405ff00000506ff00000809ff0000090aff00000b0cff00000c0dff00000e0fff00000f10ff00001011ff00",
    "001213ff00001314ff00001516ff00001617ff00001819ff00001a1bff00001c1dff00001e1fff00002021ff00002223ff00002324ff00002526ff00002627ff",
    "00002829ff0000292aff00002b2cff00002c2dff00002e2fff00002f30ff00003233ff00003334ff00003536ff00003637ff00003839ff0000393aff00003b3c",
    "ff00003c3dff00003e3fff00004041ff00004243ff00004445ff00004647ff00004849ff0000494aff00004b4cff00004c4dff00004e4fff00004f50ff000050",
    "d1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
]

red = "ff0000"
green = "00ff00"
blue = "0000ff"
white = "ffffff"

for color in [
    red,
    green,
    blue,
    white,
]:
    commands = [
        f"53430101378001{color}0102{color}02030000ff0405ff00000506ff00000809ff0000090aff00000b0cff00000c0dff00000e0fff00000f10ff00001011ff00",
        "001213ff00001314ff00001516ff00001617ff00001819ff00001a1bff00001c1dff00001e1fff00002021ff00002223ff00002324ff00002526ff00002627ff",
        "00002829ff0000292aff00002b2cff00002c2dff00002e2fff00002f30ff00003233ff00003334ff00003536ff00003637ff00003839ff0000393aff00003b3c",
        f"ff00003c3dff00003e3fff00004041ff00004243ff00004445ff00004647ff00004849ff0000494aff00004b4cff00004c4dff00004e4fff00004f50{color}50",
        "d1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    ]

    for command in commands:
        # Add a Report ID prefix (0x00) (required on Windows, optional for macOS, ? for linux)
        data_to_send = list(bytearray.fromhex(command))
        dev.write([0x00] + data_to_send)

    sleep(1)
