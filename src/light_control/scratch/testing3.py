from time import sleep

import hid

from light_control.constants import DEVICE_ID

dev = hid.device()
dev.open(**DEVICE_ID)  # use your vid/pid

red = "ff0000"
green = "00ff00"
blue = "0000ff"
white = "ffffff"

command1 = [
    f"53430101378001{red}0102{red}0203ff00000405ff00000506ff00000809ff0000090aff00000b0cff00000c0dff00000e0fff00000f10ff00001011ff00",
    "001213ff00001314ff00001516ff00001617ff00001819ff00001a1bff00001c1dff00001e1fff00002021ff00002223ff00002324ff00002526ff00002627ff",
    "00002829ff0000292aff00002b2cff00002c2dff00002e2fff00002f30ff00003233ff00003334ff00003536ff00003637ff00003839ff0000393aff00003b3c",
    "ff00003c3dff00003e3fff00004041ff00004243ff00004445ff00004647ff00004849ff0000494aff00004b4cff00004c4dff00004e4fff00004f50ff000050",
    "d1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
]

command2 = [
    f"53430101388001{green}0102{green}0203ff00000405ff00000506ff00000809ff0000090aff00000b0cff00000c0dff00000e0fff00000f10ff00001011ff00",
    "001213ff00001314ff00001516ff00001617ff00001819ff00001a1bff00001c1dff00001e1fff00002021ff00002223ff00002324ff00002526ff00002627ff",
    "00002829ff0000292aff00002b2cff00002c2dff00002e2fff00002f30ff00003233ff00003334ff00003536ff00003637ff00003839ff0000393aff00003b3c",
    "ff00003c3dff00003e3fff00004041ff00004243ff00004445ff00004647ff00004849ff0000494aff00004b4cff00004c4dff00004e4fff00004f50ff000050",
    "d2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
]

command3 = [
    f"53430101398001{blue}0102{blue}0203ff00000405ff00000506ff00000809ff0000090aff00000b0cff00000c0dff00000e0fff00000f10ff00001011ff00",
    "001213ff00001314ff00001516ff00001617ff00001819ff00001a1bff00001c1dff00001e1fff00002021ff00002223ff00002324ff00002526ff00002627ff",
    "00002829ff0000292aff00002b2cff00002c2dff00002e2fff00002f30ff00003233ff00003334ff00003536ff00003637ff00003839ff0000393aff00003b3c",
    "ff00003c3dff00003e3fff00004041ff00004243ff00004445ff00004647ff00004849ff0000494aff00004b4cff00004c4dff00004e4fff00004f50ff000050",
    "d3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
]

command4 = [
    f"534301013a8001{white}0102{white}0203ff00000405ff00000506ff00000809ff0000090aff00000b0cff00000c0dff00000e0fff00000f10ff00001011ff00",
    "001213ff00001314ff00001516ff00001617ff00001819ff00001a1bff00001c1dff00001e1fff00002021ff00002223ff00002324ff00002526ff00002627ff",
    "00002829ff0000292aff00002b2cff00002c2dff00002e2fff00002f30ff00003233ff00003334ff00003536ff00003637ff00003839ff0000393aff00003b3c",
    "ff00003c3dff00003e3fff00004041ff00004243ff00004445ff00004647ff00004849ff0000494aff00004b4cff00004c4dff00004e4fff00004f50ff000050",
    "d4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
]

command5 = [
    f"534301013b8001ff00000102ff00000203ff00000405ff00000506ff00000809ff0000090aff00000b0cff00000c0dff00000e0fff00000f10ff00001011ff00",
    "001213ff00001314ff00001516ff00001617ff00001819ff00001a1bff00001c1dff00001e1fff00002021ff00002223ff00002324ff00002526ff00002627ff",
    "00002829ff0000292aff00002b2cff00002c2dff00002e2fff00002f30ff00003233ff00003334ff00003536ff00003637ff00003839ff0000393aff00003b3c",
    "ff00003c3dff00003e3fff00004041ff00004243ff00004445ff00004647ff00004849ff0000494aff00004b4cff00004c4dff00004e4fff00004f50ff000050",
    "d5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
]

for commands in [command1, command2, command3, command4]:

    for command in commands:
        # Add a Report ID prefix (0x00) (required on Windows, optional for macOS, ? for linux)
        data_to_send = list(bytearray.fromhex(command))
        dev.write([0x00] + data_to_send)

    sleep(1)
